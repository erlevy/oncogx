imseq_reads <- imseq_reads[!duplicated(imseq_reads[,10]),, drop=FALSE]
}
if (nrow(imseq_reads)>0)
{
for (j in 1:nrow(imseq_reads))
{
nucleotide <- imseq_reads[j,10]
if (nucleotide==shared) {tumor_shared[i] <- 1}
aa <- imseq_reads[j,11]
imseq_match <- which(imseq[,1]==nucleotide)
if (length(imseq_match)==0)
{
imseq <- rbind(imseq, c(nucleotide, aa, "1"))
} else
{
imseq[imseq_match,3] <- as.character(as.numeric(imseq[imseq_match,3])+1)
}
}
}
}
imseq_tumor <- imseq
# get output of shared clonotypes with numbers in exome
shared <- "TGTGCCACCAGCAGAGACACAGAGCTGCAGTGCTTCCTGCTCTCTGTTCATAAACCTCATTGTTTCCCAGATCCAGGTGCTTTCTCT"
imseq <- matrix(nrow=0, ncol=3)
colnames(imseq) <- c("nucleotide_sequence", "aa_sequence", "number_of_patients")
tumor_shared <- rep(0, nrow(results))
imseq_dir <- "/Users/Eric/tcrseq/new/imseq/exome/"
for (i in 1:nrow(results))
{
imseq_reads <- 0
imseq_file <- paste(results$exome_uuid[i], ".tsv", sep="")
imseq_path <- paste(imseq_dir, imseq_file, sep="")
if (!file.exists(imseq_path))
{
next
}
if(file.info(imseq_path)$size!=0)
{
imseq_reads <- as.matrix(read.csv(imseq_path, sep="\t", header=T))
imseq_reads <- imseq_reads[!duplicated(imseq_reads[,10]),, drop=FALSE]
}
if (nrow(imseq_reads)>0)
{
for (j in 1:nrow(imseq_reads))
{
nucleotide <- imseq_reads[j,10]
if (nucleotide==shared) {tumor_shared[i] <- 1}
aa <- imseq_reads[j,11]
imseq_match <- which(imseq[,1]==nucleotide)
if (length(imseq_match)==0)
{
imseq <- rbind(imseq, c(nucleotide, aa, "1"))
} else
{
imseq[imseq_match,3] <- as.character(as.numeric(imseq[imseq_match,3])+1)
}
}
}
}
imseq
imseq[1,]
imseq_tumor <- imseq
write.table(imseq, "repeated_clonotypes_exome.txt", quote=FALSE, row.names=FALSE, col.names=TRUE, sep="\t")
# get output of shared clonotypes with numbers in rna
shared <- "TGTGCCACCAGCAGAGACACAGAGCTGCAGTGCTTCCTGCTCTCTGTTCATAAACCTCATTGTTTCCCAGATCCAGGTGCTTTCTCT"
imseq <- matrix(nrow=0, ncol=3)
colnames(imseq) <- c("nucleotide_sequence", "aa_sequence", "number_of_patients")
tumor_shared <- rep(0, nrow(results))
imseq_dir <- "/Users/Eric/tcrseq/new/imseq/rna/"
for (i in 1:nrow(results))
{
imseq_reads <- 0
imseq_file <- paste(results$rna_uuid[i], ".tsv", sep="")
imseq_path <- paste(imseq_dir, imseq_file, sep="")
if (!file.exists(imseq_path))
{
next
}
if(file.info(imseq_path)$size!=0)
{
imseq_reads <- as.matrix(read.csv(imseq_path, sep="\t", header=T))
imseq_reads <- imseq_reads[!duplicated(imseq_reads[,10]),, drop=FALSE]
}
if (nrow(imseq_reads)>0)
{
for (j in 1:nrow(imseq_reads))
{
nucleotide <- imseq_reads[j,10]
if (nucleotide==shared) {tumor_shared[i] <- 1}
aa <- imseq_reads[j,11]
imseq_match <- which(imseq[,1]==nucleotide)
if (length(imseq_match)==0)
{
imseq <- rbind(imseq, c(nucleotide, aa, "1"))
} else
{
imseq[imseq_match,3] <- as.character(as.numeric(imseq[imseq_match,3])+1)
}
}
}
}
imseq_tumor <- imseq
write.table(imseq, "repeated_clonotypes_rna.txt", quote=FALSE, row.names=FALSE, col.names=TRUE, sep="\t")
imseq[1]
imseq[1,]
nrow(imseq)
library(OIsurv)
library(cgdsr)
library(cluster)
library(fpc)
library(gplots)
library(heatmap.plus)
results <- read.csv("/Users/Eric/tcrseq/new/processed/pancan_exome_rna_gsva_clinical_6-14-2016.txt", sep="\t")
### FROM OLD BRCA ###
#set the table working on
library(dplyr)
library(ggplot2)
cdr3_results_current<-results
#renaming groups
#cdr3_results_current<-mutate(cdr3_results_current,clinical_group=ifelse(clinical_group=="her2-","HR+/Her2-",as.character(clinical_group)))
#cdr3_results_current<-mutate(cdr3_results_current,clinical_group=ifelse(clinical_group=="her2+","Her2+",as.character(clinical_group)))
#cdr3_results_current<-mutate(cdr3_results_current,clinical_group=ifelse(clinical_group=="triple-","TNBC",as.character(clinical_group)))
# calculating the iDNA score, rna_rpm, R and D groups
cdr3_results_current<-mutate(cdr3_results_current,exome_rpm=exome_cdr3*10^6/exome_reads)
tmp<-select(filter(cdr3_results_current,exome_rpm!=0),patient_uuid,exome_rpm)
tmp<-mutate(tmp,iDNA_score=ntile(exome_rpm,10))
cdr3_results_current<-left_join(cdr3_results_current,tmp)
cdr3_results_current<-mutate(cdr3_results_current,iDNA_score=ifelse(is.na(iDNA_score),0,iDNA_score))
cdr3_results_current<-mutate(cdr3_results_current,rna_rpm=rna_cdr3*10^6/rna_reads)
cdr3_results_current<-mutate(cdr3_results_current,D=ifelse(exome_rpm==0,"D-","D+"),R=ifelse(rna_rpm==0,"R-","R+"))
cdr3_results_current[1,]
summary(cdr3_results_current$exome_cdr3)
summary(cdr3_results_current$exome_cdr3)
summary(cdr3_results_current$rna_cdr3)
length(which(cdr3_results_current$exome_cdr3==0))
length(which(cdr3_results_current$rna_cdr3==0))
cdr3_results_current[1,]
table(cdr3_results_current[,c("D", "R")])
summary(cdr3_results_current$exome_cdr3)
summary(cdr3_results_current$rna_cdr3)
length(which(cdr3_results_current$exome_cdr3==0))
length(which(cdr3_results_current$rna_cdr3==0))
table(cdr3_results_current[,c("D", "R")])
sum(!is.na(cdr3_results_current$exome_cdr3))
### intial analysis
sum(!is.na(cdr3_results_current$exome_cdr3))
sum(!is.na(cdr3_results_current$rna_cdr3))
summary(cdr3_results_current$exome_cdr3)
summary(cdr3_results_current$rna_cdr3)
length(which(cdr3_results_current$exome_cdr3==0))
length(which(cdr3_results_current$rna_cdr3==0))
table(cdr3_results_current[,c("D", "R")])
9241-6173
8482-2126
cohorts <- split(cdr3_results_current, cdr3_results_current$cohort)
cohorts
which(boxplot)
help(boxplot)
boxplot(exome_rpm ~ cohort, data=cdr3_results_current)
table(cdr3_results_current[,c("D", "R")])
boxplot(rna_rpm ~ cohort, data=cdr3_results_current)
boxplot(exome_reads ~ cohort, data=cdr3_results_current)
boxplot(exome_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(log(exome_reads, 10) ~ cohort, data=cdr3_results_current)
boxplot(log(exome_cdr3,10) ~ cohort, data=cdr3_results_current)
boxplot(log(rna_cdr3,10) ~ cohort, data=cdr3_results_current)
boxplot(exome_reads ~ cohort, data=cdr3_results_current)
boxplot(exome_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(rna_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(log(rna_rpm, 10) ~ cohort, data=cdr3_results_current)
cdr3_results_current[1,]
boxplot(percent_tils ~ cohort, data=cdr3_results_current)
table(cdr3_results_current$cohort)
write.table(table(cdr3_results_current$cohort), "cdr3_cohort_numbers.txt", quote=FALSE)
write.table(table(cdr3_results_current$cohort), "cdr3_cohort_numbers.txt", quote=FALSE, row.names=FALSE, col.names=FALSE, sep="\t")
length(table(cdr3_results_current$cohort))
help(lapply)
boxplot(exome_reads ~ cohort, data=cdr3_results_current)
boxplot(exome_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(rna_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(log(rna_rpm, 10) ~ cohort, data=cdr3_results_current)
boxplot(percent_tils ~ cohort, data=cdr3_results_current)
boxplot(exome_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(rna_cdr3 ~ cohort, data=cdr3_results_current)
boxplot(log(rna_rpm, 10) ~ cohort, data=cdr3_results_current)
boxplot(log(rna_cdr3, 10) ~ cohort, data=cdr3_results_current)
cohorts_limited <- list(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
length(cohorts_limited)
cohorts <- cohorts_limited
boxplot(exome_reads ~ cohort, data=cdr3_results_current)
boxplot(log(rna_cdr3, 10) ~ cohort, data=cdr3_results_current)
boxplot(cohorts)
boxplot(rna_cdr3, data=cohorts_limited)
cohorts <- melt(cohorts_limited)
help(melt)
library(reshape2)
cohorts <- melt(cohorts_limited)
cohorts[1,]
cohorts[2,]
cohorts[3,]
cohorts[4,]
library(reshape)
cohorts <- melt(cohorts_limited)
cohorts[1,]
help(melt)
cohorts_limited <- rbind(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
cohorts_limited[1,]
cohorts_limited
cohorts$BLCA[1,]
cohorts$BLCA
cohorts <- split(cdr3_results_current, cdr3_results_current$cohort)
cohorts$BLCA
cohorts_limited <- rbind(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
cohorts_limited[1,]
boxplot(log(rna_cdr3, 10) ~ cohort, data=cdr3_results_current)
boxplot(log(rna_cdr3, 10) ~ cohort, data=cohorts_limited)
boxplot(log(rna_rpm, 10) ~ cohort, data=cohorts_limited)
boxplot(rna_cdr3 ~ cohort, data=cohorts_limited)
boxplot(rna_rpm ~ cohort, data=cohorts_limited)
cohorts_limited$cohort <- factor(cohorts_limited$cohort)
boxplot(rna_cdr3 ~ cohort, data=cohorts_limited)
boxplot(rna_rpm ~ cohort, data=cohorts_limited)
boxplot(log(rna_cdr3),10) ~ cohort, data=cohorts_limited)
boxplot(log(rna_cdr3,10) ~ cohort, data=cohorts_limited)
boxplot(log(rna_rpm,10) ~ cohort, data=cohorts_limited)
boxplot(rna_rpm ~ cohort, data=cohorts_limited)
cohorts_limited[1,]
cohorts_limited$exome_cdr3[1,]
cohorts_limited$exome_cdr3
cohorts_limited$exome_rpm
cohorts_limited$exome_cdr3[which(cohorts_limited$exome_cdr3==0),] <- NA
cohorts_limited$exome_cdr3[which(cohorts_limited$exome_cdr3==0)] <- NA
cohorts_limited$rna_cdr3[which(cohorts_limited$rna_cdr3==0)] <- NA
boxplot(rna_cdr3 ~ cohort, data=cohorts_limited)
boxplot(log(rna_rpm,10) ~ cohort, data=cohorts_limited)
cohorts_limited$rna_rpm
boxplot(log(rna_cdr3,10) ~ cohort, data=cohorts_limited)
boxplot(log(exome_cdr3,10) ~ cohort, data=cohorts_limited)
boxplot(log(rna_cdr3,10) ~ cohort, data=cohorts_limited)
cohorts_limited$exome_cdr3
cohorts_limited <- rbind(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
cohorts_limited$cohort <- factor(cohorts_limited$cohort)
cdr3_profile <- function(cdr3_results)
{
summary(cdr3_results$exome_cdr3)
summary(cdr3_results$rna_cdr3)
length(which(cdr3_results$exome_cdr3==0))
length(which(cdr3_results$rna_cdr3==0))
}
lapply(cdr3_profile, cohorts_limited)
lapply(cohorts_limited, cdr3_profile)
cohorts_limited_list <- list(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
lapply(cohorts_limited_list, cdr3_profile)
cdr3_profile <- function(cdr3_results)
{
c(summary(cdr3_results$exome_cdr3), summary(cdr3_results$rna_cdr3),
length(which(cdr3_results$exome_cdr3==0)), length(which(cdr3_results$rna_cdr3==0))
}
cdr3_profile <- function(cdr3_results)
{
c(summary(cdr3_results$exome_cdr3), summary(cdr3_results$rna_cdr3),
length(which(cdr3_results$exome_cdr3==0)), length(which(cdr3_results$rna_cdr3==0)))
}
lapply(cohorts_limited_list, cdr3_profile)
cohort_limited_profiling <- lapply(cohorts_limited_list, cdr3_profile)
write.table(cohort_limited_profiling, "testy.txt")
cohort_limited_profiling
lapply(cohort_limited_profiling, length)
cdr3_profile <- function(cdr3_results)
{
c(mean(cdr3_results$exome_cdr3), max(cdr3_results$exome_cdr3),
mean(cdr3_results$rna_cdr3), max(cdr3_results$rna_cdr3),
length(which(cdr3_results$exome_cdr3==0)), length(which(cdr3_results$rna_cdr3==0)))
}
cohort_limited_profiling <- lapply(cohorts_limited_list, cdr3_profile)
lapply(cohort_limited_profiling, length)
write.table(cohort_limited_profiling, "testy.txt")
cohort_limited_profiling
cohort_limited_list[[2]][1,]
cohorts_limited_list[[2]][1,]
cohorts_limited_list[[2]]$exome_cdr3
cdr3_profile <- function(cdr3_results)
{
c(mean(cdr3_results$exome_cdr3, na.rm = TRUE), max(cdr3_results$exome_cdr3, na.rm = TRUE),
mean(cdr3_results$rna_cdr3, na.rm = TRUE), max(cdr3_results$rna_cdr3, na.rm = TRUE),
length(which(cdr3_results$exome_cdr3==0)), length(which(cdr3_results$rna_cdr3==0)))
}
cohort_limited_profiling <- lapply(cohorts_limited_list, cdr3_profile)
cohorts_limited_pr
cohorts_limited_profiling
cohorts_limited_profiling <- lapply(cohorts_limited_list, cdr3_profile)
cohorts_limited_profiling
write.table(cohorts_limited_profiling, "testy.txt")
melt(cohorts_limited_profiling)
cohorts_limited_profiling <- lapply(cohorts_limited_list, cdr3_profile, sep="\t")
write.table(cohorts_limited_profiling, "testy.txt", sep="\t")
df <- do.call("rbind", cohorts_limited_profiling)
df
write.table(cohorts_limited_profiling, "12_cohorts_profiling.txt", sep="\t", quote=FALSE)
write.table(df, "12_cohorts_profiling.txt", sep="\t", quote=FALSE)
write.table(df, "12_cohorts_profiling.txt", sep="\t", quote=FALSE, row.names=FALSE, col.names=FALSE)
surv_matrix <- types$COAD
surv <- surv_matrix[,c("iDNA_nonzero", "days_compound", "vital_status")]
surv$days_compound <- surv_matrix$days_compound/365
my.surv <- Surv(as.numeric(surv[,2]), as.numeric(surv[,3]))
my.fit <- survfit(my.surv ~ surv[,1])
plot(my.fit, col=c(1,2), main="Survival of COAD by CDR3 presence", xlab="Survival Time (years)", ylab="Survival Probability")
legend(5,0.4, c("nonzero", "zero"), fill=c(1,2), cex=0.75)
coxph(my.surv ~ surv[,1], method="breslow")
### survival
### process days
cdr3_results_surv <- c()
for (i in 1:nrow(cdr3_results_current))
{
surv_row <- rep(NA, 3)
idna <- cdr3_results_current$iDNA_score[i]
days_to_death <- cdr3_results_current$days_to_death[i]
days_to_last_followup <- cdr3_results_current$days_to_last_followup[i]
vital <- NA
days <- NA
if (idna>0) {idna <- 1}
if (!is.na(days_to_death)) {
days <- days_to_death
vital <- 1
} else if (!is.na(days_to_last_followup)) {
days <- days_to_last_followup
vital <- 0
}
surv_row <- c(idna, days, vital)
cdr3_results_surv <- rbind(cdr3_results_surv, surv_row)
}
colnames(cdr3_results_surv) <- c("iDNA_nonzero", "days_compound", "vital_status")
rownames(cdr3_results_surv) <- seq(1:nrow(cdr3_results_surv))
cdr3_results_surv <- cbind(cdr3_results_current, cdr3_results_surv)
surv_results <- function(surv_matrix)
{
surv <- surv_matrix[,c("iDNA_nonzero", "days_compound", "vital_status")]
surv$days_compound <- surv_matrix$days_compound/365
my.surv <- Surv(as.numeric(surv[,2]), as.numeric(surv[,3]))
my.fit <- survfit(my.surv ~ surv[,1])
#  plot(my.fit, col=c(1,2), main="Survival of HR+ by CDR3 groups", xlab="Survival Time (years)", ylab="Survival Probability")
#  legend(0.5,0.4, c("nonzero", "zero"), fill=c(1,2), cex=0.75)
coxph(my.surv ~ surv[,1], method="breslow")
}
types <- split(cdr3_results_surv, cdr3_results_surv$cohort)
types_surv <- lapply(types, surv_results)
# looks like only COAD is significant
# close: SKCM, CESC, ACC
surv_matrix <- types$COAD
surv <- surv_matrix[,c("iDNA_nonzero", "days_compound", "vital_status")]
surv$days_compound <- surv_matrix$days_compound/365
my.surv <- Surv(as.numeric(surv[,2]), as.numeric(surv[,3]))
my.fit <- survfit(my.surv ~ surv[,1])
plot(my.fit, col=c(1,2), main="Survival of COAD by CDR3 presence", xlab="Survival Time (years)", ylab="Survival Probability")
legend(5,0.4, c("nonzero", "zero"), fill=c(1,2), cex=0.75)
coxph(my.surv ~ surv[,1], method="breslow")
### rna vs. dna clonal diversity
cdr3_results_clonality <-mutate(cdr3_results_current,exome_clonality=exome_clonotypes/exome_rpm)
cdr3_results_clonality <-mutate(cdr3_results_clonality,rna_clonality=rna_clonotypes/rna_rpm)
plot(cdr3_results_clonality$exome_rpm, cdr3_results_clonality$exome_clonotypes)
plot(cdr3_results_clonality$rna_rpm, cdr3_results_clonality$rna_clonotypes)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality)
cohorts_limited_df <- rbind(cohorts$BLCA, cohorts$BRCA, cohorts$COAD, cohorts$GBM,
cohorts$HNSC, cohorts$LGG, cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$PRAD, cohorts$STAD, cohorts$THCA)
cdr3_results_clonality <-mutate(cohorts_limited_df,exome_clonality=exome_clonotypes/exome_rpm)
cdr3_results_clonality <-mutate(cohorts_limited_df,rna_clonality=rna_clonotypes/rna_rpm)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality)
cdr3_results_clonality[1,]
cdr3_results_clonality <-mutate(cohorts_limited_df,exome_clonality=exome_clonotypes/exome_rpm)
cdr3_results_clonality <-mutate(cdr3_results_clonality,rna_clonality=rna_clonotypes/rna_rpm)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality, col=cdr3_results_clonality$cohort)
cohorts_limited_df <- rbind(cohorts$BRCA, cohorts$HNSC,cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$STAD)
cdr3_results_clonality <-mutate(cohorts_limited_df,exome_clonality=exome_clonotypes/exome_rpm)
cdr3_results_clonality <-mutate(cdr3_results_clonality,rna_clonality=rna_clonotypes/rna_rpm)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality, col=cdr3_results_clonality$cohort)
help(plot)
cdr3_results_clonality$cohort
cohorts_limited_df <- rbind(cohorts$BRCA, cohorts$HNSC,cohorts$LUAD, cohorts$LUSC,
cohorts$OV, cohorts$STAD)
cohorts_limited_df$cohort <- factor(cohorts_limited_df$cohort)
cdr3_results_clonality <-mutate(cohorts_limited_df,exome_clonality=exome_clonotypes/exome_rpm)
cdr3_results_clonality <-mutate(cdr3_results_clonality,rna_clonality=rna_clonotypes/rna_rpm)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality, col=cdr3_results_clonality$cohort)
legend(legend = levels(cdr3_results_clonality$cohort))
legend(x="topright", legend = levels(cdr3_results_clonality$cohort))
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality, col=cdr3_results_clonality$cohort, pch=2)
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality, col=cdr3_results_clonality$cohort, pch=16)
length(table(cdr3_results_clonality$cohort))
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality,
col=c("blue", "red", "black", "purple", "green", "lightblue"))
help(legend)
legend(x="topright", legend=levels(cdr3_results_clonality$cohort),
col=c("blue", "red", "black", "purple", "green", "lightblue"))
legend(x=200, y=400, legend=levels(cdr3_results_clonality$cohort),
col=c("blue", "red", "black", "purple", "green", "lightblue"))
help(legend)
legend(x=200, y=400, legend=levels(cdr3_results_clonality$cohort), pch=16,
col=c("blue", "red", "black", "purple", "green", "lightblue"))
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality,
col=c("blue", "red", "black", "purple", "green", "lightblue"), pch=16)
legend(x=200, y=400, legend=levels(cdr3_results_clonality$cohort), pch=16,
col=c("blue", "red", "black", "purple", "green", "lightblue"))
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality,
col=c("blue", "red", "black", "purple", "green", "lightblue"), pch=16)
legend(x=400, y=500, legend=levels(cdr3_results_clonality$cohort), pch=16,
col=c("blue", "red", "black", "purple", "green", "lightblue"))
plot(cdr3_results_clonality$exome_clonality, cdr3_results_clonality$rna_clonality,
col=c("blue", "red", "black", "purple", "green", "lightblue"), pch=16,
main="Clonal diversity of RNA vs. DNA", xlab="Exome clonal diversity", ylab="RNA clonal diversity")
legend(x=400, y=500, legend=levels(cdr3_results_clonality$cohort), pch=16,
col=c("blue", "red", "black", "purple", "green", "lightblue"))
results_new <- read.csv("/Users/Eric/tcrseq/new/processed/pancan_exome_rna_gsva_clinical_6-7-2016.txt", sep="\t")
results_old <- read.csv("/Users/Eric/tcrseq/new/processed/pancan_exome_gsva_clinical_dedup.txt", sep="\t")
results_holt <- read.csv("/Users/Eric/tcrseq/new/holt/TCGA_mitcr_cdr3_result_160401.tsv.datafreeze1.3.filtered.tsv", sep="\t")
clonotypes_new <- read.csv("/Users/Eric/tcrseq/new/processed/pancan_clonotypes_all_6-14.txt", sep="\t")
pancan_rna_unique_aa <- unique(clonotypes_rna$aa)
holt_unique_aa <- unique(results_holt$aaSeq)
clonotypes_new <- read.csv("/Users/Eric/tcrseq/new/processed/pancan_clonotypes_all_6-14.txt", sep="\t")
### comparing to Holt
clonotypes_rna <- clonotypes_new[clonotypes_new$rna>0,]
pancan_rna_unique_nuc <- unique(clonotypes_rna$clonotype)
holt_unique_nuc <- unique(results_holt$nucSeq)
length(intersect(pancan_rna_unique_nuc, holt_unique_nuc))
pancan_rna_unique_aa <- unique(clonotypes_rna$aa)
holt_unique_aa <- unique(results_holt$aaSeq)
pancan_rna_unique_aa[1,]
pancan_rna_unique_aa[1]
holt_unique_aa[1]
pancan_rna_unique_aa <- as.character(unique(clonotypes_rna$aa))
holt_unique_aa <- as.character(unique(results_holt$aaSeq))
length(intersect(pancan_rna_unique_aa, holt_unique_aa))
library(stringdist)
testy1 <- pancan_rna_unique_aa[1]
testy1
stringdist(testy1, holt_unique_aa)
min(stringdist(testy1, holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[1], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[2], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[3], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[4], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[5], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[6], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[7], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[8], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[9], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[10], holt_unique_aa))
min(stringdist(pancan_rna_unique_aa[11], holt_unique_aa))
distances <- c()
for (i in 1:nrow(pancan_rna_unique_aa))
{
distance <- min(stringdist(pancan_rna_unique_aa[i], holt_unique_aa))
distances <- c(distance, distances)
}
distances <- c()
for (i in 1:length(pancan_rna_unique_aa))
{
distance <- min(stringdist(pancan_rna_unique_aa[i], holt_unique_aa))
distances <- c(distance, distances)
}
length(distances)
distances
length(which(distances<2))
length(which(distances<3))
length(which(distances<4))
length(which(distances<5))
length(which(distances<6))
length(which(distances<7))
write.table(distances, "pancan_clonotypes_holt_edit_distances.txt", quote=FALSE, row.names=FALSE, col.names=FALSE)
help("stringdist")
hist(distances)
length(which(distances==0))
length(intersect(pancan_rna_unique_aa, holt_unique_aa))
length(which(distances==1))
length(which(distances==2))
length(which(distances==3))
length(which(distances==4))
length(which(distances==5))
length(which(distances==6))
length(which(distances==7))
length(which(distances==8))
length(which(distances==9))
length(which(distances==10))
length(which(distances==11))
length(which(distances==12))
length(which(distances==13))
length(which(distances==1))
length(which(distances==14))
length(which(distances==15))
length(which(distances==16))
max(distances)
distnaces
distances
summary(distances)
li_file <- "/Users/Eric/tcrseq/new/li/Supplementary_Table_1.fa"
con <- file(li_file, open="r")
line <- readLines(con)
line[1]
line[2]
line[3]
